<?xml version="1.0" encoding="UTF-8"?>


<chapter xml:id="ch_temp" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Bell Numbers</title>
  <introduction>
    <p>
      The Bell number, <m>B_{n}</m> , denotes the number of ways that a set of <m>n</m> objects <m>S</m> can be partitioned into nonempty subsets.
      The definition of <q>partition</q> implies two properties: The subsets are disjoint and their union is <m>S</m>.
    </p>

    <p>
      Essential properties and facts about <m>B_{n}</m> are summarized next.
    </p>

    <assemblage>
      <title>Bell Numbers</title>
      <p>
        <me>
          1, 1, 2, 5, 15, 52, 203, 877, 4040, 21147, 115975, \ldots
        </me>
      </p>

      <p>
        Formulas:
        <ul>
          <li>
            <m>B_{n} = S\left( n,1 \right) + S\left( n,2 \right) + S\left( n,3 \right) + \ldots + S(n,n)</m>
          </li>
          <li>
            <m>B_{n} = \frac{1}{e}\sum_{k=0}^{\infty}\frac{k^{n}}{k!}</m> (Dobinski's Formula)
          </li>
          <li>
            <m>B_{n} = L\left( x^{n} \right)</m> (Gian - Carlo Rota)
          </li>
        </ul>
      </p>
      <p>
      Recursion: <m>B_{n} = \binom{n - 1}{0}B_{0} + \binom{n - 1}{1}B_{1} + \cdots + \binom{n - 1}{n - 1}B_{n - 1}</m>; <m>B_{0} = 1</m>.
      </p>
      <p>

        E.G.F.: <m>e^{e^{x} - 1} = \sum_{k = 0}^{\infty}{B_{n}\frac{x^{n}}{n!}}</m>
      </p>
      <p>
      BELL TRIANGLE:
      </p>
      <sidebyside width="50%">

        <tabular>
        <row><cell>1</cell> <cell> </cell> <cell> </cell> <cell> </cell> <cell></cell> </row>
        <row><cell>1 </cell><cell> 2 </cell><cell> </cell><cell> </cell><cell> </cell></row>
        <row><cell>2 </cell><cell> 3 </cell><cell> 5 </cell><cell> </cell><cell> </cell></row>
        <row><cell>5 </cell><cell> 7 </cell><cell> 10 </cell><cell> 15 </cell><cell> </cell></row>
        <row><cell>15 </cell><cell> 20 </cell><cell> 27 </cell><cell> 37 </cell><cell> 52</cell></row>
        <row><cell> \ldots </cell><cell> </cell><cell> </cell><cell> </cell><cell> </cell></row>
      </tabular>
      </sidebyside>
    </assemblage>

    <p>
      Two observations: The first few Bell's look like the Catalans; the
      sequence of Bells increases in size rapidly. The Bell numbers can be
      generated by constructing what is called the Bell Triangle. To construct
      this triangle, begin with a 1 at the top and a 1 below it. Add these two
      numbers together and put the sum 2, to the right of the 1 in the second
      column. This 2 is also the first entry of the third row. The second
      entry in the third row is found by adding the 2 to the number 1 above
      it. This sum is 3 and goes to the right of the 2. The 3 is now below a
      2. Adding these two numbers produces the last number, 5, in the third
      row. Since 5 has no number above it, the third row is complete. 5 now
      becomes the first number in the fourth row and the process continuesv
    </p>

    <p>
      Construction of the triangle follows two basic rules:
      <ol>
        <li>
          <p>
            The last number of each row is the first number of the next row.
          </p>
        </li>
        <li>
          <p>
            All other numbers are found by adding the number to the left of the
            missing number to the number directly above this same number.
          </p>
        </li>
      </ol>

      When the triangle is extended, as above, the Bell Numbers are found down
      the first column as well as along the outside diagonal.
    </p>

    <sidebyside width="70%">
      <tabular>
      <row><cell>1</cell> <cell> </cell> <cell> </cell> <cell> </cell> <cell></cell><cell/><cell/> </row>
      <row><cell>1 </cell><cell> 2 </cell><cell> </cell><cell> </cell><cell> </cell><cell/><cell/> </row>
      <row><cell>2 </cell><cell> 3 </cell><cell> 5 </cell><cell> </cell><cell> </cell><cell/><cell/> </row>
      <row><cell>5 </cell><cell> 7 </cell><cell> 10 </cell><cell> 15 </cell><cell> </cell><cell/><cell/> </row>
      <row><cell>15 </cell><cell> 20 </cell><cell> 27 </cell><cell> 37 </cell><cell> 52</cell><cell/><cell/> </row>
      <row> <cell>52 </cell><cell>67</cell><cell> 87</cell><cell> 114</cell><cell> 151</cell><cell> 203</cell><cell/></row>

      <row><cell> 203 </cell><cell>255</cell><cell> 322</cell><cell> 409</cell><cell> 523</cell><cell> 674</cell><cell> 877</cell></row>
    </tabular>
    </sidebyside>

    <p>
      As with Pascal's Triangle, the Bell triangle has several interesting
      properties. If the sum of a row is added to the Bell number at the end
      of that row, the next Bell number is obtained. For example, the sum of
      the fourth row plus the Bell number at the end of the row:
      <m>15 + 20 + 27 + 37 + 52 + 52</m> is 203, the next Bell number. Also, the
      numbers of the second diagonal <m>1, 3, 10, 37, 151, 674, \ldots</m> are the
      sums of the horizontal rows. Rotating the triangle slightly creates a
      difference triangle analogous to Pascal's Triangle. The entries that are
      formed recursively by adding in Pascal's Triangle are now differences of
      the two numbers above them in the Bell triangle.
    </p>

    <sidebyside width="80%">
      <tabular>
        <row>
          <cell>1</cell><cell/><cell>2</cell><cell/><cell>5</cell><cell/><cell>15</cell><cell/><cell>52</cell><cell/><cell>203</cell><cell/><cell>877</cell><cell><m>\ldots</m></cell>
        </row>
        <row>
          <cell/><cell>1</cell><cell/><cell>3</cell><cell/><cell>10</cell><cell/><cell>37</cell><cell/><cell>151</cell><cell/><cell>674</cell><cell><m>\ldots</m></cell><cell/>
        </row>
        <row>
          <cell/><cell/>
          <cell>2</cell><cell/><cell>7</cell><cell/><cell>27</cell><cell/><cell>114</cell><cell/><cell>523</cell><cell><m>\ldots</m></cell><cell/><cell/>
        </row>
        <row>
          <cell/><cell/><cell/>
          <cell>5</cell>
          <cell/><cell>20</cell><cell/><cell>87</cell><cell/><cell>409</cell><cell><m>\ldots</m></cell><cell/><cell/><cell/>
        </row>
        <row>
          <cell/><cell/><cell/><cell/>
          <cell>15</cell>
          <cell/><cell>67</cell><cell/><cell>322</cell><cell><m>\ldots</m></cell><cell/><cell/><cell/><cell/>
        </row>
        <row>
          <cell/><cell/><cell/><cell/><cell/>
          <cell>52</cell>
          <cell/><cell>255</cell><cell><m>\ldots</m></cell><cell/><cell/><cell/><cell/><cell/>
        </row>
        <row>
          <cell/><cell/><cell/><cell/><cell/><cell/>
          <cell>203</cell>
          <cell><m>\ldots</m></cell><cell/><cell/><cell/><cell/><cell/><cell/>
        </row>
      </tabular>
    </sidebyside>

    <p>
      Finally, rewriting the Bell triangle recursively indicates a nice
      connection of the Bell Numbers to Pascal's triangle.
    </p>

    <sidebyside width="70%">
      <tabular>
        <row>
          <cell>
            <m>B_{0} = B_{1}</m>
          </cell>
          <cell/><cell/><cell/>
        </row>
        <row>
          <cell>
            <m>B_{1}</m>
          </cell>
          <cell>
            <m>B_{0} + B_{1} = B_{2}</m>
          </cell>
          <cell/><cell/>
        </row>
        <row>
          <cell>
            <m>B_{2}</m>
          </cell>
          <cell>
            <m>B_{1} + B_{2}</m>
          </cell>
          <cell>
            <m>B_{0} + 2B_{1} + B_{2} = B_{3}</m>
          </cell>
          <cell/>
        </row>
        <row>
          <cell>
            <m>B_{3}</m>
          </cell>
          <cell>
            <m>B_{2} + B_{3}</m>
          </cell>
          <cell>
            <m>B_{1} + B_{2} + B_{2} + B_{3}</m>
          </cell>
          <cell>
            <m>B_{0} + 3B_{1} + 3B_{2} + B_{3} = B_{4}</m>
          </cell>
        </row>
      </tabular>
    </sidebyside>

    <p>
      This pattern suggests the <m>{(n + 1)}^{\text{th}}</m> Bell Number can be represented recursively by <m>B_{n + 1} = \binom{n}{0} B_{0} + \binom{n}{1} B_{1} + \binom{n}{2}B_{2} + \ldots + \binom{n}{n} B_{n}</m>. The coefficients of this equation are the entries of the nth row of Pascal's triangle. You are asked to prove this recursion in the exercises
    </p>


    <p>
      The Bell numbers are related to the Stirling numbers and can be defined
      as the sum of the Stirling numbers of the second kind.
      That is, <m>B_{n} = S( n,1 ) + S( n,2 ) + \cdots + S(n,n)</m>, where <m>S(n,k)</m> represents the number of ways of grouping <m>n</m> elements into <m>k</m> subsets.
      So <m>B_{3} = S( 3,1 ) + S( 3,2 ) + S( 3,3 ) = 1 + 3 + 1 = 5</m>.
      Since the Bell numbers count the partitions of a set of elements, they are used in prime-number theory to enumerate the number of ways to factor a number with distinct prime factors.
      For example, 42 has three distinct prime factors: 2, 3, and 7.
      Since <m>B_{3} = 5</m> , we know there are five ways of factoring 42.
      These are <m>2 \times 3 \times 7</m>, <m>2 \times 21</m>, <m>3 \times 14</m>, <m>6 \times 7</m>, and <m>42</m>.
      So the number <m>210</m>, which has 4 distinct factors, 2, 3, 5, and 7, can be factored in <m>B_{4} = 15</m> ways.
    </p>

    <p>
      The Bell numbers can be used to model many real-life situations. For
      example, the number of different ways two people can sleep in unlabeled
      twin beds is <m>B_{2} = 2</m> ways: They can sleep in the same bed or in
      separate beds. The number of ways of serving a dinner consisting of
      three items, such as a salad, bread, and fish is <m>B_{3} = 5</m> ways:
      each could be served on a separate plate, salad and bread could be on
      one plate and fish on another, salad and fish on one plate and bread on
      another, or all three items could be on the same plate. This example
      serves as a model for the five ways three people can occupy three
      unlabeled beds, the five ways three prisoners can be handcuffed
      together, the five ways three nations can be form alliances, or any
      situation of partitioning three distinct elements into non-empty
      subsets.
    </p>

    <p>
      One interesting application of Bell numbers is in counting the number of
      rhyme schemes possible for a stanza in poetry. There are <m>B_{2} = 2</m> possibilities for a two-line stanza: the lines can either rhyme or not
      rhyme. The possible rhyme schemes of a three-line stanza can be
      described as aaa, aab, aba, abb, and abc: thus there are 5 or <m>B_{3}</m> possible rhyme schemes. The Japanese used diagrams depicting possible
      rhyme schemes of a five-line stanza <m>B_{5} = 52</m> as early as 1000
      A.D. in the <em>Tale of the Genji</em> by Lady Shikibu Murasaki.
    </p>
  </introduction>

  <exercises>
    <title>Problems for Bell Numbers</title>
    <introduction>
      <p>
        The Bell number (named after Eric Temple Bell, a Scottish-born American
        mathematician, who died in 1960) <m>B_{n}</m> is the number of ways of
        partitioning an <m>n</m>-set into subsets. For example, <m>B_{3} = 5</m>; the 5  ways of partitioning the elements of <m>\{1, 2, 3\}</m> are

        <me>
          \{1\} \{2\} \{3\},\quad \{1, 2\} \{3\},\quad  \{1, 3\} \{2\}, \quad \{2, 3\} \{1\}, \quad \{1, 2, 3\}
        </me>
      </p>
    </introduction>

    <exercise>
      <statement>
        <p>
          Compute <m>B_{1}</m>, <m>B_{2}</m>, and <m>B_{4}</m> by listing all the relevant partitions.
        </p>
      </statement>
    </exercise>

    <exercise xml:id="ex-bell-as-stirlings">
      <statement>
        <p>
          Explain why <m>B_{n} = S\left( n,1 \right) + S\left( n,2 \right) + \cdots + S(n,n)</m>.
        </p>
      </statement>
    </exercise>

    <exercise>
      <statement>
        <p>
          Compute <m>B_{5}</m>, <m>B_{6}</m>, <m>B_{7}</m>, and <m>B_{8}</m> using a table of Stirling numbers <m>S(n,k)</m> and the formula in <xref ref="ex-bell-as-stirlings"/>.
        </p>
      </statement>
    </exercise>

    <exercise xml:id="ex-bell-recurrence">
      <statement>
        <p>
          Prove that <m>B_{n} =  \binom{n - 1}{0} B_{0} + \binom{n - 1}{1} B_{1} + \binom{n - 1}{2} B_{2} + \cdots + \binom{n - 1}{n - 1} B_{n - 1}</m>.  Here we let <m>B_0 = 1</m>.
        </p>
      </statement>
      <hint>
        <p>
          First try n=5 and partition <m>\{ 1,2,3,4,5\}</m> by treating 5 as <q>special.</q>
          The element 5 can be a singleton, in a doubleton, or etc.
        </p>
      </hint>
    </exercise>

    <exercise xml:id="ex-stirling-recurrence">
      <statement>
        <p>
          Prove that <m>S_{n}(n + 1, r) = \binom{n}{0} S(0, r - 1) + \binom{n}{1} S(1, r - 1) + \binom{n}{2} S(2, r - 1) + \cdots + \binom{n}{n} S(n, r - 1)</m>
        </p>
      </statement>
    </exercise>

    <exercise>
      <statement>
        <p>
          Using the results in <xref ref="ex-bell-as-stirlings"/> and <xref ref="ex-stirling-recurrence"/>, give another proof of the recurrence in <xref ref="ex-bell-recurrence"/>.
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          The set <m>\{u_{0}, u_{1}, u_{2}, \ldots \}</m> where <m>u_{0} = 1</m>, <m>u_{1} = x</m>, <m>u_{2} = x(x - 1)</m>, <m>u_{3} = x(x - 1)(x - 2)</m>, etc., is a basis for the vector space <m>V</m> of all polynomials with real coefficients.
          Let <m>P(x) = c_{0}u_{0} + c_{1}u_{1} + c_{2}u_{2} + \cdots</m> be any element of <m>V</m>, and define the functional <m>L</m> as follows: <m>L\lbrack P(x)\rbrack = c_{0} + c_{1} + \cdots</m>.
        </p>
        <p>
          <ol>
            <li>
              <p>
                Prove that <m>L\left\lbrack P\left( x \right) + Q\left( x \right) \right\rbrack = L\left\lbrack P\left( x \right) \right\rbrack + L\left\lbrack Q\left( x \right) \right\rbrack.</m>
              </p>
            </li>
            <li>
              <p>
                Prove that <m>L\left\lbrack \text{rP}\left( x \right) \right\rbrack = rL\lbrack P\left( x \right)\rbrack</m> for <m>r \in \R</m> (the Reals).
              </p>
            </li>
            <li>
              <p>
                Prove that <m>B_{n} = L\lbrack x^{n}\rbrack</m> .
              </p>
            </li>
            <li>
              <p>
                Prove that <m>L\left\lbrack x^{n + 1} \right\rbrack = L\lbrack\left( x + 1 \right)^{n}\rbrack</m> .
              </p>
            </li>
            <li>
              <p>
                Derive the recursion in <xref ref="ex-bell-recurrence"/> using the previous part.
              </p>
            </li>
          </ol>
        </p>
      </statement>
    </exercise>
  </exercises>

</chapter>
